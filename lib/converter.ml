type rule = { from : string; to_ : string }

let replace_with_rule rule input =
  let len = Array.length rule in
  let rec loop i output =
    match i < len with
    | false -> output
    | _ ->
        let r = rule.(i) in
        let from = r.from in
        let to_ = r.to_ in
        let regex = Str.regexp (Str.quote from) in
        loop (i + 1) (Str.global_replace regex (Str.quote to_) output)
  in
  loop 0 input

  let uni2zg input =
  let uni2zg_rule =
    [|
      { from = "\u{1004}\u{103a}\u{1039}"; to_ = "\u{1064}" };
      { from = "\u{1039}\u{1010}\u{103d}"; to_ = "\u{1096}" };
      { from = "\u{102b}\u{103a}"; to_ = "\u{105a}" };
      { from = "\u{102d}\u{1036}"; to_ = "\u{108e}" };
      { from = "\u{104e}\u{1004}\u{103a}\u{1038}"; to_ = "\u{104e}" };
      { from = "[\u{1025}\u{1009}](?=\u{1039})"; to_ = "\u{106a}" };
      { from = "\u{1009}(?=[\u{102f}\u{1030}])"; to_ = "\u{1025}" };
      { from = "[\u{1025}\u{1009}](?=[\u{1037}]?[\u{103a}])"; to_ = "\u{1025}" };
      { from = "\u{100a}(?=[\u{1039}\u{103d}])"; to_ = "\u{106b}" };
      {
        from = "(\u{1039}[\u{1000}-\u{1021}])(\u{102D}){0;1}\u{102f}";
        to_ = "$1$2\u{1033}";
      };
      { from = "(\u{1039}[\u{1000}-\u{1021}])\u{1030}"; to_ = "$1\u{1034}" };
      {
        from =
          "\u{1014}(?=[\u{102d}\u{102e}\u{102f}\u{103A}]?[\u{1030}\u{103d}\u{103e}\u{102f}\u{1039}])";
        to_ = "\u{108f}";
      };
      { from = "\u{1014}(?=\u{103A}\u{102F} )"; to_ = "\u{108f}" };
      { from = "\u{1014}\u{103c}"; to_ = "\u{108f}\u{103c}" };
      { from = "\u{1039}\u{1000}"; to_ = "\u{1060}" };
      { from = "\u{1039}\u{1001}"; to_ = "\u{1061}" };
      { from = "\u{1039}\u{1002}"; to_ = "\u{1062}" };
      { from = "\u{1039}\u{1003}"; to_ = "\u{1063}" };
      { from = "\u{1039}\u{1005}"; to_ = "\u{1065}" };
      { from = "\u{1039}\u{1006}"; to_ = "\u{1066}" };
      { from = "\u{1039}\u{1007}"; to_ = "\u{1068}" };
      { from = "\u{1039}\u{1008}"; to_ = "\u{1069}" };
      { from = "\u{1039}\u{100b}"; to_ = "\u{106c}" };
      { from = "\u{100b}\u{1039}\u{100c}"; to_ = "\u{1092}" };
      { from = "\u{1039}\u{100c}"; to_ = "\u{106d}" };
      { from = "\u{100d}\u{1039}\u{100d}"; to_ = "\u{106e}" };
      { from = "\u{100d}\u{1039}\u{100e}"; to_ = "\u{106f}" };
      { from = "\u{1039}\u{100f}"; to_ = "\u{1070}" };
      { from = "\u{1039}\u{1010}"; to_ = "\u{1071}" };
      { from = "\u{1039}\u{1011}"; to_ = "\u{1073}" };
      { from = "\u{1039}\u{1012}"; to_ = "\u{1075}" };
      { from = "\u{1039}\u{1013}"; to_ = "\u{1076}" };
      { from = "\u{1039}[\u{1014}\u{108f}]"; to_ = "\u{1077}" };
      { from = "\u{1039}\u{1015}"; to_ = "\u{1078}" };
      { from = "\u{1039}\u{1016}"; to_ = "\u{1079}" };
      { from = "\u{1039}\u{1017}"; to_ = "\u{107a}" };
      { from = "\u{1039}\u{1018}"; to_ = "\u{107b}" };
      { from = "\u{1039}\u{1019}"; to_ = "\u{107c}" };
      { from = "\u{1039}\u{101c}"; to_ = "\u{1085}" };
      { from = "\u{103f}"; to_ = "\u{1086}" };
      { from = "\u{103d}\u{103e}"; to_ = "\u{108a}" };
      {
        from = "(\u{1064})([\u{1000}-\u{1021}])([\u{103b}\u{103c}]?)\u{102d}";
        to_ = "$2$3\u{108b}";
      };
      {
        from = "(\u{1064})([\u{1000}-\u{1021}])([\u{103b}\u{103c}]?)\u{102e}";
        to_ = "$2$3\u{108c}";
      };
      {
        from = "(\u{1064})([\u{1000}-\u{1021}])([\u{103b}\u{103c}]?)\u{1036}";
        to_ = "$2$3\u{108d}";
      };
      {
        from =
          "(\u{1064})([\u{1000}-\u{1021}\u{1040}-\u{1049}])([\u{103b}\u{103c}]?)([\u{1031}]?)";
        to_ = "$2$3$4$1";
      };
      {
        from =
          "\u{101b}(?=([\u{102d}\u{102e}]?)[\u{102f}\u{1030}\u{103d}\u{108a}])";
        to_ = "\u{1090}";
      };
      { from = "\u{100f}\u{1039}\u{100d}"; to_ = "\u{1091}" };
      { from = "\u{100b}\u{1039}\u{100b}"; to_ = "\u{1097}" };
      {
        from =
          "([\u{1000}-\u{1021}\u{108f}\u{1029}\u{106a}\u{106e}\u{106f}\u{1086}\u{1090}\u{1091}\u{1092}\u{1097}\u{1096}])([\u{1060}-\u{1069}\u{106c}\u{106d}\u{1070}-\u{107c}\u{1085}\u{108a}])?([\u{103b}-\u{103e}]*)?\u{1031}";
        to_ = "\u{1031}$1$2$3";
      };
      { from = "\u{103c}\u{103e}"; to_ = "\u{103c}\u{1087}" };
      {
        from =
          "([\u{1000}-\u{1021}\u{108f}\u{1029}])([\u{1060}-\u{1069}\u{106c}\u{106d}\u{1070}-\u{107c}\u{1085}])?(\u{103c})";
        to_ = "$3$1$2";
      };
      { from = "\u{103a}"; to_ = "\u{1039}" };
      { from = "\u{103b}"; to_ = "\u{103a}" };
      { from = "\u{103c}"; to_ = "\u{103b}" };
      { from = "\u{103d}"; to_ = "\u{103c}" };
      { from = "\u{103e}"; to_ = "\u{103d}" };
      {
        from = "([^\u{103a}\u{100a}])\u{103d}([\u{102d}\u{102e}]?)\u{102f}";
        to_ = "$1\u{1088}$2";
      };
      {
        from =
          "([\u{101b}\u{103a}\u{103c}\u{108a}\u{1088}\u{1090}])([\u{1030}\u{103d}])?([\u{1032}\u{1036}\u{1039}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)(\u{102f})?\u{1037}";
        to_ = "$1$2$3$4\u{1095}";
      };
      {
        from =
          "([\u{102f}\u{1014}\u{1030}\u{103d}])([\u{1032}\u{1036}\u{1039}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)\u{1037}";
        to_ = "$1$2\u{1094}";
      };
      {
        from =
          "([\u{103b}])([\u{1000}-\u{1021}])([\u{1087}]?)([\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)\u{102f}";
        to_ = "$1$2$3$4\u{1033}";
      };
      {
        from =
          "([\u{103b}])([\u{1000}-\u{1021}])([\u{1087}]?)([\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)\u{1030}";
        to_ = "$1$2$3$4\u{1034}";
      };
      {
        from =
          "([\u{103a}\u{103c}\u{100a}\u{1008}\u{100b}\u{100c}\u{100d}\u{1020}\u{1025}])([\u{103d}]?)([\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)\u{102f}";
        to_ = "$1$2$3\u{1033}";
      };
      {
        from =
          "([\u{103a}\u{103c}\u{100a}\u{1008}\u{100b}\u{100c}\u{100d}\u{1020}\u{1025}])(\u{103d}?)([\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}]?)\u{1030}";
        to_ = "$1$2$3\u{1034}";
      };
      { from = "([\u{100a}\u{1020}\u{1009}])\u{103d}"; to_ = "$1\u{1087}" };
      { from = "\u{103d}\u{1030}"; to_ = "\u{1089}" };
      {
        from =
          "\u{103b}([\u{1000}\u{1003}\u{1006}\u{100f}\u{1010}\u{1011}\u{1018}\u{101a}\u{101c}\u{101a}\u{101e}\u{101f}])";
        to_ = "\u{107e}$1";
      };
      {
        from =
          "\u{107e}([\u{1000}\u{1003}\u{1006}\u{100f}\u{1010}\u{1011}\u{1018}\u{101a}\u{101c}\u{101a}\u{101e}\u{101f}])([\u{103c}\u{108a}])([\u{1032}\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}])";
        to_ = "\u{1084}$1$2$3";
      };
      {
        from =
          "\u{107e}([\u{1000}\u{1003}\u{1006}\u{100f}\u{1010}\u{1011}\u{1018}\u{101a}\u{101c}\u{101a}\u{101e}\u{101f}])([\u{103c}\u{108a}])";
        to_ = "\u{1082}$1$2";
      };
      {
        from =
          "\u{107e}([\u{1000}\u{1003}\u{1006}\u{100f}\u{1010}\u{1011}\u{1018}\u{101a}\u{101c}\u{101a}\u{101e}\u{101f}])([\u{1033}\u{1034}]?)([\u{1032}\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}])";
        to_ = "\u{1080}$1$2$3";
      };
      {
        from =
          "\u{103b}([\u{1000}-\u{1021}])([\u{103c}\u{108a}])([\u{1032}\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}])";
        to_ = "\u{1083}$1$2$3";
      };
      {
        from = "\u{103b}([\u{1000}-\u{1021}])([\u{103c}\u{108a}])";
        to_ = "\u{1081}$1$2";
      };
      {
        from =
          "\u{103b}([\u{1000}-\u{1021}])([\u{1033}\u{1034}]?)([\u{1032}\u{1036}\u{102d}\u{102e}\u{108b}\u{108c}\u{108d}\u{108e}])";
        to_ = "\u{107f}$1$2$3";
      };
      { from = "\u{103a}\u{103d}"; to_ = "\u{103d}\u{103a}" };
      { from = "\u{103a}([\u{103c}\u{108a}])"; to_ = "$1\u{107d}" };
      { from = "([\u{1033}\u{1034}])(\u{1036}?)\u{1094}"; to_ = "$1$2\u{1095}" };
      { from = "\u{108F}\u{1071}"; to_ = "\u{108F}\u{1072}" };
      { from = "\u{108F}\u{1073}"; to_ = "\u{108F}\u{1074}" };
      {
        from = "([\u{1000}-\u{1021}])([\u{107B}\u{1066}])\u{102C}";
        to_ = "$1\u{102C}$2";
      };
      {
        from = "\u{102C}([\u{107B}\u{1066}])\u{1037}";
        to_ = "\u{102C}$1\u{1094}";
      };
      {
        from =
          "\u{1047}((?=[\u{1000}-\u{1021}]\u{1039})|(?=[\u{102c}-\u{1030}\u{1032}\u{1036}-\u{1038}\u{103c}\u{103d}]))";
        to_ = "\u{101b}";
      };
    |]
  in
  replace_with_rule uni2zg_rule input
  
let zg2uni input =
  let zg2uni_rule =
    [|
      {
        from = "([\u{102D}\u{102E}\u{103D}\u{102F}\u{1037}\u{1095}])\\\\1+";
        to_ = "$1";
      };
      { from = "\u{200B}"; to_ = "" };
      { from = "\u{103d}\u{103c}"; to_ = "\u{108a}" };
      { from = "(\u{103d}|\u{1087})"; to_ = "\u{103e}" };
      { from = "\u{103c}"; to_ = "\u{103d}" };
      {
        from =
          "(\u{103b}|\u{107e}|\u{107f}|\u{1080}|\u{1081}|\u{1082}|\u{1083}|\u{1084})";
        to_ = "\u{103c}";
      };
      { from = "(\u{103a}|\u{107d})"; to_ = "\u{103b}" };
      { from = "\u{1039}"; to_ = "\u{103a}" };
      { from = "(\u{1066}|\u{1067})"; to_ = "\u{1039}\u{1006}" };
      { from = "\u{106a}"; to_ = "\u{1009}" };
      { from = "\u{106b}"; to_ = "\u{100a}" };
      { from = "\u{106c}"; to_ = "\u{1039}\u{100b}" };
      { from = "\u{106d}"; to_ = "\u{1039}\u{100c}" };
      { from = "\u{106e}"; to_ = "\u{100d}\u{1039}\u{100d}" };
      { from = "\u{106f}"; to_ = "\u{100d}\u{1039}\u{100e}" };
      { from = "\u{1070}"; to_ = "\u{1039}\u{100f}" };
      { from = "(\u{1071}|\u{1072})"; to_ = "\u{1039}\u{1010}" };
      { from = "\u{1060}"; to_ = "\u{1039}\u{1000}" };
      { from = "\u{1061}"; to_ = "\u{1039}\u{1001}" };
      { from = "\u{1062}"; to_ = "\u{1039}\u{1002}" };
      { from = "\u{1063}"; to_ = "\u{1039}\u{1003}" };
      { from = "\u{1065}"; to_ = "\u{1039}\u{1005}" };
      { from = "\u{1068}"; to_ = "\u{1039}\u{1007}" };
      { from = "\u{1069}"; to_ = "\u{1039}\u{1008}" };
      { from = "(\u{1073}|\u{1074})"; to_ = "\u{1039}\u{1011}" };
      { from = "\u{1075}"; to_ = "\u{1039}\u{1012}" };
      { from = "\u{1076}"; to_ = "\u{1039}\u{1013}" };
      { from = "\u{1077}"; to_ = "\u{1039}\u{1014}" };
      { from = "\u{1078}"; to_ = "\u{1039}\u{1015}" };
      { from = "\u{1079}"; to_ = "\u{1039}\u{1016}" };
      { from = "\u{107a}"; to_ = "\u{1039}\u{1017}" };
      { from = "\u{107c}"; to_ = "\u{1039}\u{1019}" };
      { from = "\u{1085}"; to_ = "\u{1039}\u{101c}" };
      { from = "\u{1033}"; to_ = "\u{102f}" };
      { from = "\u{1034}"; to_ = "\u{1030}" };
      { from = "\u{103f}"; to_ = "\u{1030}" };
      { from = "\u{1086}"; to_ = "\u{103f}" };
      { from = "\u{1036}\u{1088}"; to_ = "\u{1088}\u{1036}" };
      { from = "\u{1088}"; to_ = "\u{103e}\u{102f}" };
      { from = "\u{1089}"; to_ = "\u{103e}\u{1030}" };
      { from = "\u{108a}"; to_ = "\u{103d}\u{103e}" };
      { from = "\u{103B}\u{1064}"; to_ = "\u{1064}\u{103B}" };
      {
        from = "\u{103c}([\u{1000}-\u{1021}])([\u{1064}\u{108b}\u{108d}])";
        to_ = "$1\u{103c}$2";
      };
      {
        from =
          "(\u{1031})?([\u{1000}-\u{1021}\u{1040}-\u{1049}])(\u{103c})?\u{1064}";
        to_ = "\u{1004}\u{103a}\u{1039}$1$2$3";
      };
      {
        from = "(\u{1031})?([\u{1000}-\u{1021}])(\u{103b}|\u{103c})?\u{108b}";
        to_ = "\u{1004}\u{103a}\u{1039}$1$2$3\u{102d}";
      };
      {
        from = "(\u{1031})?([\u{1000}-\u{1021}])(\u{103b})?\u{108c}";
        to_ = "\u{1004}\u{103a}\u{1039}$1$2$3\u{102e}";
      };
      {
        from = "(\u{1031})?([\u{1000}-\u{1021}])([\u{103b}\u{103c}])?\u{108d}";
        to_ = "\u{1004}\u{103a}\u{1039}$1$2$3\u{1036}";
      };
      { from = "\u{108e}"; to_ = "\u{102d}\u{1036}" };
      { from = "\u{108f}"; to_ = "\u{1014}" };
      { from = "\u{1090}"; to_ = "\u{101b}" };
      { from = "\u{1091}"; to_ = "\u{100f}\u{1039}\u{100d}" };
      { from = "\u{1092}"; to_ = "\u{100b}\u{1039}\u{100c}" };
      {
        from = "\u{1019}\u{102c}(\u{107b}|\u{1093})";
        to_ = "\u{1019}\u{1039}\u{1018}\u{102c}";
      };
      { from = "(\u{107b}|\u{1093})"; to_ = "\u{1039}\u{1018}" };
      { from = "(\u{1094}|\u{1095})"; to_ = "\u{1037}" };
      {
        from = "([\u{1000}-\u{1021}])\u{1037}\u{1032}";
        to_ = "$1\u{1032}\u{1037}";
      };
      { from = "\u{1096}"; to_ = "\u{1039}\u{1010}\u{103d}" };
      { from = "\u{1097}"; to_ = "\u{100b}\u{1039}\u{100b}" };
      {
        from = "\u{103c}([\u{1000}-\u{1021}])([\u{1000}-\u{1021}])?";
        to_ = "$1\u{103c}$2";
      };
      {
        from = "([\u{1000}-\u{1021}])\u{103c}\u{103a}";
        to_ = "\u{103c}$1\u{103a}";
      };
      {
        from =
          "\u{1047}(?=[\u{102c}-\u{1030}\u{1032}\u{1036}-\u{1038}\u{103d}\u{1038}])";
        to_ = "\u{101b}";
      };
      { from = "\u{1031}\u{1047}"; to_ = "\u{1031}\u{101b}" };
      {
        from =
          "\u{1040}(\u{102e}|\u{102f}|\u{102d}\u{102f}|\u{1030}|\u{1036}|\u{103d}|\u{103e})";
        to_ = "\u{101d}$1";
      };
      {
        from =
          "([^\u{1040}\u{1041}\u{1042}\u{1043}\u{1044}\u{1045}\u{1046}\u{1047}\u{1048}\u{1049}])\u{1040}\u{102b}";
        to_ = "$1\u{101d}\u{102b}";
      };
      {
        from =
          "([\u{1040}\u{1041}\u{1042}\u{1043}\u{1044}\u{1045}\u{1046}\u{1047}\u{1048}\u{1049}])\u{1040}\u{102b}(?!\u{1038})";
        to_ = "$1\u{101d}\u{102b}";
      };
      { from = "^\u{1040}(?=\u{102b})"; to_ = "\u{101d}" };
      { from = "\u{1040}\u{102d}(?!\u{0020}?/)"; to_ = "\u{101d}\u{102d}" };
      {
        from =
          "([^\u{1040}-\u{1049}])\u{1040}([^\u{1040}-\u{1049}\u{0020}]|[\u{104a}\u{104b}])";
        to_ = "$1\u{101d}$2";
      };
      {
        from = "([^\u{1040}-\u{1049}])\u{1040}(?=[\\\\f\\\\n\\\\r])";
        to_ = "$1\u{101d}";
      };
      { from = "([^\u{1040}-\u{1049}])\u{1040}$"; to_ = "$1\u{101d}" };
      {
        from = "\u{1031}([\u{1000}-\u{1021}\u{103f}])(\u{103e})?(\u{103b})?";
        to_ = "$1$2$3\u{1031}";
      };
      {
        from =
          "([\u{1000}-\u{1021}])\u{1031}([\u{103b}\u{103c}\u{103d}\u{103e}]+)";
        to_ = "$1$2\u{1031}";
      };
      { from = "\u{1032}\u{103d}"; to_ = "\u{103d}\u{1032}" };
      { from = "([\u{102d}\u{102e}])\u{103b}"; to_ = "\u{103b}$1" };
      { from = "\u{103d}\u{103b}"; to_ = "\u{103b}\u{103d}" };
      { from = "\u{103a}\u{1037}"; to_ = "\u{1037}\u{103a}" };
      {
        from = "\u{102f}(\u{102d}|\u{102e}|\u{1036}|\u{1037})\u{102f}";
        to_ = "\u{102f}$1";
      };
      { from = "(\u{102f}|\u{1030})(\u{102d}|\u{102e})"; to_ = "$2$1" };
      { from = "(\u{103e})(\u{103b}|\u{103c})"; to_ = "$2$1" };
      { from = "\u{1025}(?=[\u{1037}]?[\u{103a}\u{102c}])"; to_ = "\u{1009}" };
      { from = "\u{1025}\u{102e}"; to_ = "\u{1026}" };
      { from = "\u{1005}\u{103b}"; to_ = "\u{1008}" };
      { from = "\u{1036}(\u{102f}|\u{1030})"; to_ = "$1\u{1036}" };
      { from = "\u{1031}\u{1037}\u{103e}"; to_ = "\u{103e}\u{1031}\u{1037}" };
      { from = "\u{1031}\u{103e}\u{102c}"; to_ = "\u{103e}\u{1031}\u{102c}" };
      { from = "\u{105a}"; to_ = "\u{102b}\u{103a}" };
      { from = "\u{1031}\u{103b}\u{103e}"; to_ = "\u{103b}\u{103e}\u{1031}" };
      { from = "(\u{102d}|\u{102e})(\u{103d}|\u{103e})"; to_ = "$2$1" };
      {
        from = "\u{102c}\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{1039}$1\u{102c}";
      };
      {
        from = "\u{1039}\u{103c}\u{103a}\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{103a}\u{1039}$1\u{103c}";
      };
      {
        from = "\u{103c}\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{1039}$1\u{103c}";
      };
      {
        from = "\u{1036}\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{1039}$1\u{1036}";
      };
      { from = "\u{104e}"; to_ = "\u{104e}\u{1004}\u{103a}\u{1038}" };
      { from = "\u{1040}(\u{102b}|\u{102c}|\u{1036})"; to_ = "\u{101d}$1" };
      { from = "\u{1025}\u{1039}"; to_ = "\u{1009}\u{1039}" };
      {
        from = "([\u{1000}-\u{1021}])\u{103c}\u{1031}\u{103d}";
        to_ = "$1\u{103c}\u{103d}\u{1031}";
      };
      {
        from = "([\u{1000}-\u{1021}])\u{103b}\u{1031}\u{103d}(\u{103e})?";
        to_ = "$1\u{103b}\u{103d}$2\u{1031}";
      };
      {
        from = "([\u{1000}-\u{1021}])\u{103d}\u{1031}\u{103b}";
        to_ = "$1\u{103b}\u{103d}\u{1031}";
      };
      {
        from =
          "([\u{1000}-\u{1021}])\u{1031}(\u{1039}[\u{1000}-\u{1021}]\u{103d}?)";
        to_ = "$1$2\u{1031}";
      };
      { from = "\u{1038}\u{103a}"; to_ = "\u{103a}\u{1038}" };
      { from = "\u{102d}\u{103a}|\u{103a}\u{102d}"; to_ = "\u{102d}" };
      { from = "\u{102d}\u{102f}\u{103a}"; to_ = "\u{102d}\u{102f}" };
      { from = "\u{0020}\u{1037}"; to_ = "\u{1037}" };
      { from = "\u{1037}\u{1036}"; to_ = "\u{1036}\u{1037}" };
      { from = "[\u{102d}]+"; to_ = "\u{102d}" };
      { from = "[\u{103a}]+"; to_ = "\u{103a}" };
      { from = "[\u{103d}]+"; to_ = "\u{103d}" };
      { from = "[\u{1037}]+"; to_ = "\u{1037}" };
      { from = "[\u{102e}]+"; to_ = "\u{102e}" };
      { from = "\u{102d}\u{102e}|\u{102e}\u{102d}"; to_ = "\u{102e}" };
      { from = "\u{102f}\u{102d}"; to_ = "\u{102d}\u{102f}" };
      { from = "\u{1037}\u{1037}"; to_ = "\u{1037}" };
      { from = "\u{1032}\u{1032}"; to_ = "\u{1032}" };
      {
        from = "\u{1044}\u{1004}\u{103a}\u{1038}";
        to_ = "\u{104E}\u{1004}\u{103a}\u{1038}";
      };
      {
        from = "([\u{102d}\u{102e}])\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{1039}$2$1";
      };
      {
        from = "(\u{103c}\u{1031})\u{1039}([\u{1000}-\u{1021}])";
        to_ = "\u{1039}$2$1";
      };
      { from = "\u{1036}\u{103d}"; to_ = "\u{103d}\u{1036}" };
      {
        from =
          "\u{1047}((?=[\u{1000}-\u{1021}]\u{103a})|(?=[\u{102c}-\u{1030}\u{1032}\u{1036}-\u{1038}\u{103d}\u{103e}]))";
        to_ = "\u{101b}";
      };
    |]
  in
  replace_with_rule zg2uni_rule input